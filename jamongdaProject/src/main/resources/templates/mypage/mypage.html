<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
    xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="layout/layout">
<head>
<meta charset="UTF-8">
<title>마이페이지</title>
<script src="http://code.jquery.com/jquery-latest.min.js"></script>
<script type="text/javascript" th:src="@{/js/common.js}"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<style>
	html,
	body {
	  position: relative;
	  min-width: 1250px;
	  max-width: 1920px;
	  margin: 0 auto;
	}

	body {
	  background: rgb(252, 252, 252);
	  font-family: Helvetica Neue, Helvetica, Arial, sans-serif;
	  font-size: 14px;
	  color: #000;
	  margin: 0 auto;
	  padding: 0 auto;
	  /*background-color: #f4f4f4;*/
	}

	.mypage-container {
	    width: 40%;
	    margin: 50px auto;
	    padding: 20px;
	    background-color: #fff;
	    border-radius: 10px;
	    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
	}

	.header {
	    margin-bottom: 20px;
	}

	.header-content {
	    display: flex;
	    align-items: center; /* 수직 중앙 정렬 */
	    justify-content: space-between; /* 여백을 자동으로 배분 */
		float: left;
		margin: 20px 0;
	}

	.review-link, .reBooking-link {
		padding: 10px 50px;
		border: 1px solid #ddd;
		border-radius: 5px;
		background-color: #fafafa;
	}
	
	.review-link:hover, .reBooking-link:hover {
	    background-color: rgb(212, 212, 212); /* Darker green on hover */
	}

	.booking-history h2{
	    margin-bottom: 20px;
		margin-left: 10px;
	}

	.booking-card {
	    border: 1px solid #ddd;
	    border-radius: 5px;
	    background-color: #fafafa;
	    padding: 20px;
	    margin-bottom: 20px;
	}

	.booking-header {
	    display: flex;
	    justify-content: space-between;
	    align-items: center;
	    border-bottom: 1px solid #ddd;
	    padding-bottom: 10px;
	    margin-bottom: 10px;
	}

	.booking-header .booking-date,
	.booking-header .booking-number {
	    font-size: 14px;
	    color: #777;
	}

	.details-link {
		color: rgb(131, 131, 131) !important;
	    text-decoration: none;
		font-weight: normal;
	    font-size: 14px;
	}

	.booking-content {
	    display: flex;
	    align-items: center;
	}

	.acc-image {
	    border-radius: 5px;
	    margin-right: 20px;
	}

	.hotel-info {
	    font-size: 1.2em;
	}

	.hotel-info .acc-name {
	    font-weight: bold;
	    font-size: 1.4em;
	    margin-bottom: 5px;
	}

	.hotel-info .ro_name,
	.hotel-info .booking-dates,
	.hotel-info .check-in-out {
	    margin-bottom: 5px;
	}
	
.myReviews-btn {
	width: 100%;
	padding: 10px;
	border: 1px solid #ddd;
	border-radius: 5px;
	background-color: #fafafa;
	margin-bottom: 20px;
	cursor: pointer;
	text-align: left;
}
.hello {
	font-weight: bold;
    font-size: 2em;
	margin-left: 10px;
    margin-right: 20px; /* 버튼과의 간격 조정 */
}
.myInfo-btn {
  background: none; /* 배경 제거 */
  border: none; /* 테두리 제거 */
  cursor: pointer; /* 커서를 포인터로 변경 */
  font-size: 16px; /* 폰트 사이즈 조정 */
  padding: 0; /* 패딩 제거 */
  margin: 0; /* 마진 제거 */
}

.myInfo-btn:hover, .details-link:hover, .myReviews-btn:hover {
  background-color: rgb(223, 223, 223);
}

.faq-notice {
    width: 100%;
    height: 100px;
    display: flex;
    justify-content: center; /* 중앙 정렬 */
    align-items: center; /* 수직 중앙 정렬 */
    font-size: 1.5em;
}

.faq-btn, .notice-btn {
    width: 50%;
    display: flex;
    justify-content: center; /* 아이콘과 텍스트를 가운데 정렬 */
    align-items: center; /* 아이콘과 텍스트를 수직 가운데 정렬 */
    position: relative; /* ::after 가상 요소를 사용하기 위해 position을 relative로 설정 */
}

.faq-btn::after {
    content: '';
    position: absolute;
    top: 10px; /* 구분선의 위쪽 여백 조정 */
    right: 0;
    width: 1px; /* 구분선의 두께 */
    height: 80%; /* 구분선의 높이 (부모의 높이에 비례) */
    background-color: #ccc; /* 구분선 색상 */
    z-index: 1; /* 다른 요소보다 위에 표시되도록 설정 */
}

.faq-btn a, .notice-btn a {
    display: flex;
    justify-content: center; /* 아이콘과 텍스트를 가운데 정렬 */
    align-items: center; /* 아이콘과 텍스트를 수직 가운데 정렬 */
    width: 100%; /* 버튼 영역 전체를 클릭 가능하게 설정 */
    height: 50px; /* 버튼 영역 전체를 클릭 가능하게 설정 */
    text-decoration: none; /* 기본 링크 밑줄 제거 */
    color: inherit; /* 텍스트 색상 상속 */
    padding: 0 10px; /* 좌우 패딩 조정 (필요시 조정) */
    box-sizing: border-box; /* 패딩과 테두리를 포함하여 너비와 높이 계산 */
    text-align: center; /* 텍스트 가운데 정렬 */
}

.review-booking-btn {
	display: flex;
	margin-top: 20px;
	justify-content: center;
	align-items: center;
	gap: 5px;
}

.review-link, .reBooking-link {
    display: inline-block; /* 너비를 적용할 수 있게 설정 */
    width: 100%; /* 원하는 너비를 설정 */
    padding: 10px 20px; /* 적절한 패딩 추가 */
    border: 1px solid #ddd;
    border-radius: 5px;
    text-align: center; /* 텍스트 가운데 정렬 */
}

.faq-notice a:hover {
	background-color: rgb(233, 233, 233);
}
.center-section {
	margin-left: 10px;
}
</style>
<script>	
	function openPopup(boNumber) {
	    var url = '/mypage/myBookingDetails.do?number=' + encodeURIComponent(boNumber);
		
		// 팝업창 위치 조정하기
		var popupW = 600;
		var popupH = 700;
		var top = Math.ceil((window.screen.height - popupH)/2);
		var left = Math.ceil((window.screen.width - popupW)/2);
		var option='width=' + popupW + ',height=' + popupH + ',scrollbars=yes, top=' + top + ',left=' + left + ', resizable=yes';
		
	    window.open(url, 'popup', option);
	}
</script>
</head>
<body>
    <th:block layout:fragment="content">
		<div class="mypage-container">
		    <div class="header">
				<div class="header-content">
				    <p class="hello" th:text="${guest.name} + '님'"></p>
				    <form action="/member/updateMemberForm.do" method="post" id="updateMemberForm">
				        <input type="hidden" name="email" th:value="${guest.email}">
				        <input type="hidden" name="ro_id" th:value="${latestBooking.ro_id}">
				        <button type="submit" class="myInfo-btn">내 정보 관리 ></button>
				    </form>
				</div>
		    </div>
			
	        <div class="reviews">
				<form action="/mypage/myReviews.do" method="post" id="myReviews">
				    <input type="hidden" name="email" th:value="${guest.email}">
				    <button type="submit" class="myReviews-btn">내가 작성한 리뷰 보러가기 <i class="fa-solid fa-pen"></i> </button>
				</form>
	        </div>
			
		    <div class="booking-history">
		    	<div>
			        <h2><i class="fa-solid fa-check"></i> 예약내역 <a href="/mypage/allBookings.do" class="details-link">전체 내역보기</a></h2>
		    	</div>
				<div class="booking-card" th:if="${latestBooking != null}">
				    <div class="booking-header">
				        <span class="booking-number" th:text="'예약번호 : ' + ${latestBooking['bo_number']}"></span>
				        <span class="booking-date" th:text="'결제일자 : ' + ${latestBooking['payDate']}"></span>
						<a href="#" class="details-link" th:attr="onclick='openPopup(' + ${latestBooking['bo_number']} + ')'">상세보기</a>						
				    </div>
				    <div class="booking-content">
				        <div class="hotel-info">
				            <div class="acc-name" th:text="${latestBooking['acc_name']}"></div>
				            <div class="ro_name" th:text="${latestBooking['ro_name']}"></div>
							<br>
				            <div class="booking-dates" th:text="${latestBooking['bo_checkIn']} + ' ~ ' + ${latestBooking['bo_checkOut']}"></div>
				            <div class="check-in-out" th:text="'체크인 ' + ${latestBooking['ro_checkIn']} + ' | 체크아웃 ' + ${latestBooking['ro_checkOut']}"></div>
				        </div>
				    </div>
					<div class="review-booking-btn">
						<a th:href="@{/review/reviewForm.do(number=${latestBooking.bo_number},aname=${latestBooking.acc_name},rid=${latestBooking.ro_id},rname=${latestBooking.ro_name})}" class="review-link" th:if="${isPastCheckout}">리뷰 등록</a>
						<a th:href="@{/search/detailSearch.do(aid=${latestBooking.acc_id})}" class="reBooking-link">다시 예약</a>
					</div>
				</div>
		    </div>
			
			<!-- 고객센터 섹션 -->
			<div class="center-section">
				<h2><i class="fa-solid fa-headset"></i> 고객센터</h2>
				<div>
					<div class="faq-notice">
						<div class="faq-btn">
							<a href="/board/FAQ.do">
								<i class="fa-regular fa-circle-question"></i>&nbsp;
								<span> FAQ</span>
							</a>
						</div>
						<div class="notice-btn">
							<a href="/board/boardList.do">
								<i class="fa-solid fa-bullhorn"></i>&nbsp;
								<span> 공지사항</span>
							</a>
						</div>
					</div>
				</div>
			</div>
		</div>
    </th:block>
</body>
</html>
